<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Jsonp</title>
	<style type="text/css">
		p{
			margin: 0 auto;
			padding: 0;
		}
		.contianer{
			width: 800px;
			margin: 50px auto;
		}
		#movie{
			width: 800px;
			overflow: hidden;
		}
		.box{
			position: relative;
			float: left;
			width:240px;
			height: 400px;
			overflow:hidden;
			margin-right: 26px;
		}
		.img{
			width:240px;
		}
		.image{
			width: 240px;
			height: 340px
			max-height: 340px;
			transition: all 0.4s;
		}
		.info{
			position: absolute;
			bottom: 0;
			width:240px;
			text-align: center;
			margin-bottom: 10px;
		}
		.image:hover{
			 
			 margin-top: -20px;
		}
	</style>
</head>
<body>
	<div class="contianer">
		<button id="getJson">点击获取电影最近动态</button>
		<p id="test-jsonp">hellow</p>
		<div id="movie">
			<!-- <div id="box">
				<div id="img">
					<img id="image" src="">
				</div>
				<p id="info"></p> -->
			</div>
		</div>
	</div>
	<script type="text/javascript">
		function refreshPrice(data) {
			let movie = document.getElementById('movie');
			let{count,subjects} = data
			for(let{rating:{average},genres,title,images:{large}} of subjects){
				let
					box = document.createElement('div'),
					imgbox = document.createElement('div'),
					img = document.createElement('img'),
					info = document.createElement('p');
				box.className = 'box'; 
				imgbox.className = 'img'; 
				img.className = 'image'; 
				info.className = 'info'; 
				img.src = large;
				info.innerHTML = title;
				imgbox.appendChild(img)
				box.appendChild(imgbox)
				box.appendChild(info)
				movie.appendChild(box);
			}

		}
		function getMovie() {
			var p = document.getElementById('test-jsonp')
			p.innerHTML = "正在获取电影数据"
			var
				js = document.createElement('script'),
				head = document.getElementsByTagName('head')[0];
			js.src = 'http://api.douban.com/v2/movie/in_theaters?callback=refreshPrice';
			head.appendChild(js);
			p.innerHTML = "拿到数据，渲染dom"
		}
		var button = document.getElementById('getJson')
		button.onclick=function(){
			getMovie()
		}
	</script>
</body>
</html>